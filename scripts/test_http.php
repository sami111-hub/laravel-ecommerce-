<?php
/**
 * Ø³ÙƒØ±Ø¨Øª Ø§Ø®ØªØ¨Ø§Ø± HTTP Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
 * ÙŠØ®ØªØ¨Ø± Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ø¨Ø± HTTP requests Ù…Ø¨Ø§Ø´Ø±Ø©
 */

$baseUrl = 'http://127.0.0.1:8080';

echo "\n";
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘           ðŸŒ Ø§Ø®ØªØ¨Ø§Ø± HTTP Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹                       â•‘\n";
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

$passed = 0;
$failed = 0;
$results = [];

function testUrl($url, $name, $expectedStatus = 200) {
    global $passed, $failed, $results, $baseUrl;
    
    $fullUrl = $baseUrl . $url;
    
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $fullUrl);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($ch, CURLOPT_TIMEOUT, 30);
    curl_setopt($ch, CURLOPT_NOBODY, false);
    curl_setopt($ch, CURLOPT_HEADER, false);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    $error = curl_error($ch);
    curl_close($ch);
    
    if ($error) {
        echo "âŒ {$name}: Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ - {$error}\n";
        $failed++;
        $results[] = ['name' => $name, 'url' => $url, 'status' => 'failed', 'error' => $error];
        return;
    }
    
    if ($httpCode === $expectedStatus) {
        echo "âœ… {$name} (HTTP {$httpCode})\n";
        $passed++;
        $results[] = ['name' => $name, 'url' => $url, 'status' => 'passed', 'http_code' => $httpCode];
    } else {
        echo "âŒ {$name}: HTTP {$httpCode} (Ù…ØªÙˆÙ‚Ø¹ {$expectedStatus})\n";
        $failed++;
        $results[] = ['name' => $name, 'url' => $url, 'status' => 'failed', 'http_code' => $httpCode, 'expected' => $expectedStatus];
    }
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ¹Ù…Ù„
echo "ðŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±...\n";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $baseUrl);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 5);
curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);

if ($httpCode == 0) {
    echo "âŒ Ø§Ù„Ø³ÙŠØ±ÙØ± ØºÙŠØ± Ù…ØªØ§Ø­ Ø¹Ù„Ù‰ {$baseUrl}\n";
    echo "   ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±: php artisan serve --port=8080\n\n";
    exit(1);
}

echo "âœ… Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ¹Ù…Ù„\n\n";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "ðŸ“„ === Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ===\n";

testUrl('/', 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
testUrl('/products', 'ØµÙØ­Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');
testUrl('/categories', 'ØµÙØ­Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª');
testUrl('/offers', 'ØµÙØ­Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶');
testUrl('/compare', 'ØµÙØ­Ø© Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ØµÙØ­Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\nðŸ” === ØµÙØ­Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ===\n";

testUrl('/login', 'ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
testUrl('/register', 'ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„');
testUrl('/auth', 'ØµÙØ­Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\nðŸ“ === Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© ===\n";

testUrl('/faq', 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©');
testUrl('/return-policy', 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹');
testUrl('/terms', 'Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…');
testUrl('/privacy', 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©');
testUrl('/about', 'Ù…Ù† Ù†Ø­Ù†');
testUrl('/contact', 'Ø§ØªØµÙ„ Ø¨Ù†Ø§');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API Ùˆ SEO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\nðŸ”Œ === API Ùˆ SEO ===\n";

testUrl('/api/recommendations', 'API Ø§Ù„ØªÙˆØµÙŠØ§Øª');
testUrl('/sitemap.xml', 'Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹');
testUrl('/products/search?q=phone', 'Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ØµÙØ­Ø§Øª ØªØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ (ØªØ¹ÙŠØ¯ ØµÙØ­Ø© Ø£Ùˆ ØªÙˆØ¬ÙŠÙ‡ - ÙƒÙ„Ø§Ù‡Ù…Ø§ Ù…Ù‚Ø¨ÙˆÙ„)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\nðŸ”’ === ØµÙØ­Ø§Øª ØªØªØ·Ù„Ø¨ Ù…ØµØ§Ø¯Ù‚Ø© (ÙŠØ¬Ø¨ Ø£Ù† ØªØ¹Ù…Ù„) ===\n";

testUrl('/cart', 'Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚', 200); // ØªØ¹Ø±Ø¶ ØµÙØ­Ø© (ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø³Ù„Ø© ÙØ§Ø±ØºØ©)
testUrl('/wishlist', 'Ø§Ù„Ù…ÙØ¶Ù„Ø©', 200);
testUrl('/orders', 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 200);
testUrl('/dashboard', 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 200);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\nðŸ›ï¸ === Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ===\n";

testUrl('/admin', 'Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', 200); // ØªØ¹Ø±Ø¶ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ù„ÙˆØ­Ø©

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo "\n";
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘                   ðŸ“‹ Ù†ØªÙŠØ¬Ø© Ø§Ø®ØªØ¨Ø§Ø± HTTP                       â•‘\n";
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\n";
printf("â•‘   âœ… Ù†Ø¬Ø­: %-4d                                              â•‘\n", $passed);
printf("â•‘   âŒ ÙØ´Ù„: %-4d                                              â•‘\n", $failed);
printf("â•‘   ðŸ“Š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: %-4d                                          â•‘\n", $passed + $failed);
$percentage = ($passed + $failed) > 0 ? round(($passed / ($passed + $failed)) * 100, 1) : 0;
printf("â•‘   ðŸ“ˆ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: %s%%                                      â•‘\n", $percentage);
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n";

if ($failed > 0) {
    echo "\nâš ï¸  Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©:\n";
    foreach ($results as $result) {
        if ($result['status'] === 'failed') {
            $error = isset($result['error']) ? $result['error'] : "HTTP {$result['http_code']}";
            echo "   âŒ {$result['name']} ({$result['url']}): {$error}\n";
        }
    }
}

echo "\n";
exit($failed > 0 ? 1 : 0);
