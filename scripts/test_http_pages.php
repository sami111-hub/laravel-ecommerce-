<?php
/**
 * ğŸŒ Ø§Ø®ØªØ¨Ø§Ø± HTTP Ù„Ø¬Ù…ÙŠØ¹ ØµÙØ­Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
 * ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
 */

$baseUrl = 'http://127.0.0.1:8000';

echo "\n";
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘       ğŸŒ Ø§Ø®ØªØ¨Ø§Ø± HTTP Ù„ØµÙØ­Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©                        â•‘\n";
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

// Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© (Ø¨Ø¯ÙˆÙ† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„)
$publicPages = [
    '/' => 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
    '/products' => 'ØµÙØ­Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
    '/offers' => 'ØµÙØ­Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶',
    '/login' => 'ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
    '/register' => 'ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„',
];

// ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (ØªØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ - Ù†ØªÙˆÙ‚Ø¹ redirect)
$adminPages = [
    '/admin' => 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…',
    '/admin/products' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
    '/admin/categories' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª',
    '/admin/orders' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª',
    '/admin/users' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
    '/admin/roles' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Ø±',
    '/admin/permissions' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª',
    '/admin/offers' => 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶',
    '/admin/settings/promo-bar' => 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„ØªØ±ÙˆÙŠØ¬ÙŠ',
];

$success = 0;
$failed = 0;
$redirects = 0;

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "ğŸŒ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:\n";
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";

foreach ($publicPages as $path => $name) {
    $result = testPage($baseUrl . $path);
    if ($result['status'] >= 200 && $result['status'] < 300) {
        echo "   âœ… [{$result['status']}] {$name}\n";
        $success++;
    } elseif ($result['status'] >= 300 && $result['status'] < 400) {
        echo "   ğŸ”„ [{$result['status']}] {$name} â†’ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡\n";
        $redirects++;
    } else {
        echo "   âŒ [{$result['status']}] {$name}\n";
        $failed++;
    }
}

echo "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø¨Ø¯ÙˆÙ† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„):\n";
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "   â„¹ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ù…Ù† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„\n\n";

foreach ($adminPages as $path => $name) {
    $result = testPage($baseUrl . $path, true);
    if ($result['status'] >= 200 && $result['status'] < 300) {
        echo "   âœ… [{$result['status']}] {$name}\n";
        $success++;
    } elseif ($result['status'] >= 300 && $result['status'] < 400) {
        echo "   ğŸ”„ [{$result['status']}] {$name} â†’ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¯Ø®ÙˆÙ„ (Ù…ØªÙˆÙ‚Ø¹)\n";
        $redirects++;
    } elseif ($result['status'] == 500) {
        echo "   âŒ [{$result['status']}] {$name} â†’ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…!\n";
        $failed++;
    } else {
        echo "   âš ï¸ [{$result['status']}] {$name}\n";
    }
}

// Ø§Ø®ØªØ¨Ø§Ø± API endpoints
echo "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "ğŸ”Œ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‚Ø§Ø· API:\n";
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";

$apiEndpoints = [
    '/products?page=1' => 'ØªØµÙØ­ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
    '/products?category=1' => 'ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ØªØµÙ†ÙŠÙ',
];

foreach ($apiEndpoints as $path => $name) {
    $result = testPage($baseUrl . $path);
    if ($result['status'] >= 200 && $result['status'] < 400) {
        echo "   âœ… [{$result['status']}] {$name}\n";
        $success++;
    } else {
        echo "   âŒ [{$result['status']}] {$name}\n";
        $failed++;
    }
}

// Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©
echo "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©:\n";
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";

$staticFiles = [
    '/css/app.css' => 'Ù…Ù„Ù CSS',
    '/js/app.js' => 'Ù…Ù„Ù JavaScript',
    '/build/manifest.json' => 'Vite Manifest',
];

foreach ($staticFiles as $path => $name) {
    $result = testPage($baseUrl . $path);
    if ($result['status'] >= 200 && $result['status'] < 400) {
        echo "   âœ… [{$result['status']}] {$name}\n";
    } else {
        echo "   âš ï¸ [{$result['status']}] {$name} (Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø·Ø¨ÙŠØ¹ÙŠ)\n";
    }
}

// Ù…Ù„Ø®Øµ
echo "\n";
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
echo "â•‘                      ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±                           â•‘\n";
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

echo "   âœ… Ù†Ø§Ø¬Ø­: {$success}\n";
echo "   ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡: {$redirects}\n";
echo "   âŒ ÙØ´Ù„: {$failed}\n\n";

if ($failed == 0) {
    echo "ğŸ‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­!\n";
} else {
    echo "âš ï¸ ÙŠÙˆØ¬Ø¯ {$failed} ØµÙØ­Ø§Øª ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø©\n";
}

echo "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙŠØ¯ÙˆÙŠ:\n";
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n";
echo "   ğŸ  Ø§Ù„Ù…ÙˆÙ‚Ø¹: {$baseUrl}\n";
echo "   ğŸ” Ø§Ù„Ø¯Ø®ÙˆÙ„: {$baseUrl}/login\n";
echo "   ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…: {$baseUrl}/admin\n";
echo "\n   ğŸ“§ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:\n";
echo "   Email: admin@gmail.com\n";
echo "   Password: (ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ)\n";
echo "\n";

function testPage($url, $followRedirect = false) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, $followRedirect);
    curl_setopt($ch, CURLOPT_TIMEOUT, 10);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_NOBODY, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    $error = curl_error($ch);
    curl_close($ch);
    
    return [
        'status' => $httpCode ?: 0,
        'error' => $error,
    ];
}
